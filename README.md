# Sprite Fusion Pixel Snapper

**Online version**: https://spritefusion.com/pixel-snapper

A tool to snap pixels to a perfect grid. Designed to fix messy and inconsistent pixel art generated by AI.

<img src="./static/hero.png" alt="Pixel Snapper" style="width: 100%; image-rendering: pixelated;">

## Why ?

**Current AI image models can't understand grid-based pixel art.**

- Pixel are inconsistent in size and position.
- The grid resolution can drift over time.
- Colors are not tied to a strict palette.

**With Pixel Snapper:**

- ‚úÖ Pixel are snapped to a perfect grid.
- ‚úÖ The grid resolution is consistent and can be scaled to pixel resolution.
- ‚úÖ Colors are tied to a strict, quantized palette.

## Perfect for

- **AI generated pixel art** that needs to be snapped to a grid.
- **Procedural 2D art that doesn't fit a grid** like tilemaps or isometric maps.
- **2D game assets and 3D textures** that need to be perfectly scalable.

<img src="./static/details.png" alt="Details" style="width: 100%; image-rendering: pixelated;">

<p align="center"><em>Pixel Snapper preserves as much details as possible like dithering.</em></p>

<br>

## How it works

Pixel Snapper analyzes the input image to detect the underlying pixel grid, then resamples and quantizes accordingly:

1. **Color quantization** ‚Äî K-means clustering reduces the image to a strict palette of `k` colors (default 16, configurable from 2‚Äì64).
2. **Grid detection** ‚Äî Gradient profiles are computed along both axes to find repeating grid boundaries. An adaptive walker algorithm locates the exact cut positions.
3. **Resampling** ‚Äî Each detected grid cell is collapsed into a single output pixel via majority voting, producing a clean image at the **native pixel art resolution**.

### Output resolution

The output image will be **smaller than the input**. This is by design. For example, a 1024√ó1024 image with an underlying ~5px grid will produce roughly a 200√ó200 output ‚Äî the true pixel art resolution with one pixel per grid cell. To display it at the original size, scale it up with nearest-neighbor interpolation (`image-rendering: pixelated` in CSS).

<br>

## Pixel Snapper comes in three flavors

### üé® Web UI (frontend)

The easiest way to use Pixel Snapper. Requires [Rust](https://www.rust-lang.org/) and [Node.js](https://nodejs.org/).

```bash
git clone https://github.com/Hugo-Dz/spritefusion-pixel-snapper.git
cd spritefusion-pixel-snapper
```

Build the WASM module and start the frontend:

```bash
wasm-pack build --target web --out-dir pkg --release
cd spritefusion-frontend
npm install
npm run dev
```

Then open the URL shown in your terminal. Drag and drop an image, adjust the color count, and compare before/after with the interactive slider.

### üíª CLI

Requires [Rust](https://www.rust-lang.org/) installed on your machine.

```bash
git clone https://github.com/Hugo-Dz/spritefusion-pixel-snapper.git
cd spritefusion-pixel-snapper
```

```bash
cargo run input.png output.png
```

The command accepts an optional k-colors argument:

```bash
cargo run input.png output.png 16
```

### üåê WASM (library)

For integrating Pixel Snapper into your own web project.

```bash
wasm-pack build --target web --out-dir pkg --release
```

Then import and use the WASM module:

```js
import init, { process_image } from './pkg/spritefusion_pixel_snapper.js';

await init();
const inputBytes = new Uint8Array(/* PNG or JPEG bytes */);
const outputPng = process_image(inputBytes, 16); // 16 colors
```

The `process_image` function takes raw image bytes (PNG/JPEG) and an optional color count, and returns PNG bytes of the processed image.

## Acknowledgments

Pixel Snapper is a [Sprite Fusion](https://spritefusion.com) project. Sprite Fusion is a free, web-based tilemap editor for game developers supporting a wide range of engines including Unity, Godot, Defold, and GB Studio.

<img src="./static/spritefusion.webp" alt="Sprite Fusion" style="width: 100%;">

## License

MIT License [Hugo Duprez](https://www.hugoduprez.com/)
